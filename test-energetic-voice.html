<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í™œê¸°ì°¬ ìŒì„± ìƒì„± í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }
        input[type="text"], textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .generate-btn {
            background-color: #4CAF50;
            color: white;
        }
        .generate-btn:hover {
            background-color: #45a049;
        }
        .generate-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .preset-btn {
            background-color: #2196F3;
            color: white;
        }
        .preset-btn:hover {
            background-color: #1976D2;
        }
        .result {
            margin-top: 30px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
        }
        .result h3 {
            margin-top: 0;
            color: #333;
        }
        audio {
            width: 100%;
            margin-top: 10px;
        }
        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
        }
        .error {
            color: #f44336;
            padding: 10px;
            background-color: #ffebee;
            border-radius: 5px;
            margin-top: 10px;
        }
        .success {
            color: #4CAF50;
            padding: 10px;
            background-color: #e8f5e9;
            border-radius: 5px;
            margin-top: 10px;
        }
        .emotion-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        .emotion-btn {
            padding: 8px 16px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .emotion-btn.active {
            background-color: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }
        .presets {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        .presets h4 {
            margin-top: 0;
            color: #666;
        }
        .preset-item {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .preset-item:hover {
            background-color: #e3f2fd;
            transform: translateX(5px);
        }
        .info-box {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }
        .info-box h4 {
            margin-top: 0;
            color: #1976D2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ‰ í™œê¸°ì°¬ í•œêµ­ì–´ ìŒì„± ìƒì„± í…ŒìŠ¤íŠ¸</h1>
        
        <div class="info-box">
            <h4>â„¹ï¸ í…ŒìŠ¤íŠ¸ í™˜ê²½ ì•ˆë‚´</h4>
            <p>1. ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤: <code>npm run dev</code></p>
            <p>2. ElevenLabs API í‚¤ê°€ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤</p>
            <p>3. ìƒì„±ëœ ìŒì„±ì€ ì•„ë˜ì—ì„œ ë°”ë¡œ ì¬ìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
        </div>

        <form id="voiceForm">
            <div class="form-group">
                <label for="text">í…ìŠ¤íŠ¸ ì…ë ¥ (í•„ìˆ˜)</label>
                <textarea id="text" name="text" placeholder="ë³€í™˜í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ì€ ì •ë§ ì¢‹ì€ ë‚ ì´ì—ìš”! ì—¬ëŸ¬ë¶„ê³¼ í•¨ê»˜í•  ìˆ˜ ìˆì–´ì„œ ê¸°ë»ìš”!</textarea>
            </div>

            <div class="form-group">
                <label>ê°ì • ì„ íƒ</label>
                <div class="emotion-buttons">
                    <button type="button" class="emotion-btn active" data-emotion="excited">ğŸ˜Š ì‹ ë‚¨ (Excited)</button>
                    <button type="button" class="emotion-btn" data-emotion="motivated">ğŸ’ª ë™ê¸°ë¶€ì—¬ (Motivated)</button>
                    <button type="button" class="emotion-btn" data-emotion="enthusiastic">ğŸ¯ ì—´ì •ì  (Enthusiastic)</button>
                    <button type="button" class="emotion-btn" data-emotion="cheerful">ğŸ˜„ ëª…ë‘í•¨ (Cheerful)</button>
                    <button type="button" class="emotion-btn" data-emotion="celebratory">ğŸŠ ì¶•í•˜ (Celebratory)</button>
                </div>
                <input type="hidden" id="emotion" name="emotion" value="excited">
            </div>

            <div class="form-group">
                <label for="gender">ì„±ë³„</label>
                <select id="gender" name="gender">
                    <option value="">ìë™ ì„ íƒ</option>
                    <option value="male">ë‚¨ì„±</option>
                    <option value="female">ì—¬ì„±</option>
                </select>
            </div>

            <div class="form-group">
                <label for="intensity">ê°•ë„</label>
                <select id="intensity" name="intensity">
                    <option value="low">ë‚®ìŒ</option>
                    <option value="medium" selected>ì¤‘ê°„</option>
                    <option value="high">ë†’ìŒ</option>
                </select>
            </div>

            <div class="form-group">
                <label for="videoType">ë¹„ë””ì˜¤ íƒ€ì… (ì„ íƒ)</label>
                <select id="videoType" name="videoType">
                    <option value="">ì§ì ‘ ì„¤ì •</option>
                    <option value="advertisement">ê´‘ê³ </option>
                    <option value="tutorial">íŠœí† ë¦¬ì–¼</option>
                    <option value="motivation">ë™ê¸°ë¶€ì—¬</option>
                    <option value="celebration">ì¶•í•˜</option>
                </select>
            </div>

            <div class="button-group">
                <button type="submit" class="generate-btn" id="generateBtn">ğŸ¤ ìŒì„± ìƒì„±í•˜ê¸°</button>
            </div>
        </form>

        <div class="presets">
            <h4>ğŸ¯ ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ í”„ë¦¬ì…‹</h4>
            <div class="preset-item" onclick="applyPreset('ê´‘ê³ ')">
                ğŸ“¢ <strong>ê´‘ê³ </strong> - "ì§€ê¸ˆ ë°”ë¡œ ë§Œë‚˜ë³´ì„¸ìš”! ë†“ì¹˜ë©´ í›„íšŒí•˜ëŠ” íŠ¹ë³„í•œ ê¸°íšŒ!"
            </div>
            <div class="preset-item" onclick="applyPreset('ë™ê¸°ë¶€ì—¬')">
                ğŸ’ª <strong>ë™ê¸°ë¶€ì—¬</strong> - "í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ë‹¹ì‹ ì˜ ê¿ˆì„ í–¥í•´ ë‹¬ë ¤ê°€ì„¸ìš”!"
            </div>
            <div class="preset-item" onclick="applyPreset('ì¶•í•˜')">
                ğŸ‰ <strong>ì¶•í•˜</strong> - "ì¶•í•˜ë“œë ¤ìš”! ì •ë§ ëŒ€ë‹¨í•œ ì„±ê³¼ë¥¼ ì´ë£¨ì…¨ë„¤ìš”!"
            </div>
            <div class="preset-item" onclick="applyPreset('íŠœí† ë¦¬ì–¼')">
                ğŸ“š <strong>íŠœí† ë¦¬ì–¼</strong> - "ì, ì´ì œ í•¨ê»˜ ë°°ì›Œë³¼ê¹Œìš”? ì•„ì£¼ ì‰½ê³  ì¬ë¯¸ìˆì–´ìš”!"
            </div>
        </div>

        <div id="result" class="result" style="display: none;">
            <h3>ìƒì„± ê²°ê³¼</h3>
            <div id="resultContent"></div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:3000/api/tts/energetic';
        const form = document.getElementById('voiceForm');
        const resultDiv = document.getElementById('result');
        const resultContent = document.getElementById('resultContent');
        const generateBtn = document.getElementById('generateBtn');

        // ê°ì • ë²„íŠ¼ ì´ë²¤íŠ¸
        document.querySelectorAll('.emotion-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.emotion-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                document.getElementById('emotion').value = this.getAttribute('data-emotion');
            });
        });

        // í”„ë¦¬ì…‹ ì ìš© í•¨ìˆ˜
        function applyPreset(type) {
            const presets = {
                'ê´‘ê³ ': {
                    text: 'ì§€ê¸ˆ ë°”ë¡œ ë§Œë‚˜ë³´ì„¸ìš”! ë†“ì¹˜ë©´ í›„íšŒí•˜ëŠ” íŠ¹ë³„í•œ ê¸°íšŒ! ì´ë²ˆ ì£¼ë§ê¹Œì§€ íŠ¹ë³„ í• ì¸!',
                    videoType: 'advertisement',
                    emotion: 'enthusiastic',
                    intensity: 'high'
                },
                'ë™ê¸°ë¶€ì—¬': {
                    text: 'í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ë‹¹ì‹ ì˜ ê¿ˆì„ í–¥í•´ ë‹¬ë ¤ê°€ì„¸ìš”! í¬ê¸°í•˜ì§€ ë§ˆì„¸ìš”! íŒŒì´íŒ…!',
                    videoType: 'motivation',
                    emotion: 'motivated',
                    intensity: 'high',
                    gender: 'male'
                },
                'ì¶•í•˜': {
                    text: 'ì¶•í•˜ë“œë ¤ìš”! ì •ë§ ëŒ€ë‹¨í•œ ì„±ê³¼ë¥¼ ì´ë£¨ì…¨ë„¤ìš”! ë„ˆë¬´ë„ˆë¬´ ê¸°ë»ìš”!',
                    videoType: 'celebration',
                    emotion: 'celebratory',
                    intensity: 'medium',
                    gender: 'female'
                },
                'íŠœí† ë¦¬ì–¼': {
                    text: 'ì, ì´ì œ í•¨ê»˜ ë°°ì›Œë³¼ê¹Œìš”? ì•„ì£¼ ì‰½ê³  ì¬ë¯¸ìˆì–´ìš”! ì°¨ê·¼ì°¨ê·¼ ë”°ë¼í•´ë³´ì„¸ìš”!',
                    videoType: 'tutorial',
                    emotion: 'cheerful',
                    intensity: 'medium'
                }
            };

            const preset = presets[type];
            if (preset) {
                document.getElementById('text').value = preset.text;
                document.getElementById('videoType').value = preset.videoType || '';
                document.getElementById('emotion').value = preset.emotion || 'excited';
                document.getElementById('intensity').value = preset.intensity || 'medium';
                document.getElementById('gender').value = preset.gender || '';

                // ê°ì • ë²„íŠ¼ ì—…ë°ì´íŠ¸
                document.querySelectorAll('.emotion-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-emotion') === preset.emotion) {
                        btn.classList.add('active');
                    }
                });
            }
        }

        // í¼ ì œì¶œ ì´ë²¤íŠ¸
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(form);
            const data = {
                text: formData.get('text'),
                emotion: formData.get('emotion'),
                gender: formData.get('gender') || undefined,
                intensity: formData.get('intensity'),
                videoType: formData.get('videoType') || undefined
            };

            // ë¹ˆ ê°’ ì œê±°
            Object.keys(data).forEach(key => {
                if (!data[key]) delete data[key];
            });

            generateBtn.disabled = true;
            generateBtn.textContent = 'â³ ìƒì„± ì¤‘...';
            resultDiv.style.display = 'block';
            resultContent.innerHTML = '<div class="loading">ìŒì„±ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</div>';

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (result.success) {
                    resultContent.innerHTML = `
                        <div class="success">âœ… ìŒì„± ìƒì„± ì„±ê³µ!</div>
                        <p><strong>ì‚¬ìš©ëœ ìŒì„±:</strong> ${result.data.voiceUsed}</p>
                        <p><strong>ê°ì •:</strong> ${result.data.emotion}</p>
                        <p><strong>ê°•ë„:</strong> ${result.data.intensity}</p>
                        <p><strong>ê¸¸ì´:</strong> ${result.data.duration}ì´ˆ</p>
                        <audio controls autoplay>
                            <source src="${result.data.audioUrl}" type="audio/wav">
                            ë¸Œë¼ìš°ì €ê°€ ì˜¤ë””ì˜¤ ì¬ìƒì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                        </audio>
                    `;
                } else {
                    resultContent.innerHTML = `<div class="error">âŒ ì˜¤ë¥˜: ${result.error}</div>`;
                }
            } catch (error) {
                resultContent.innerHTML = `
                    <div class="error">
                        âŒ ì„œë²„ ì—°ê²° ì‹¤íŒ¨<br>
                        ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš”: <code>npm run dev</code>
                    </div>
                `;
            } finally {
                generateBtn.disabled = false;
                generateBtn.textContent = 'ğŸ¤ ìŒì„± ìƒì„±í•˜ê¸°';
            }
        });

        // ì„œë²„ ìƒíƒœ í™•ì¸
        async function checkServer() {
            try {
                const response = await fetch(API_URL, { method: 'GET' });
                if (response.ok) {
                    console.log('âœ… API ì„œë²„ ì—°ê²° ì„±ê³µ');
                }
            } catch (error) {
                resultDiv.style.display = 'block';
                resultContent.innerHTML = `
                    <div class="error">
                        âš ï¸ ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.<br>
                        í„°ë¯¸ë„ì—ì„œ <code>npm run dev</code> ëª…ë ¹ìœ¼ë¡œ ì„œë²„ë¥¼ ì‹œì‘í•˜ì„¸ìš”.
                    </div>
                `;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì„œë²„ í™•ì¸
        checkServer();
    </script>
</body>
</html>