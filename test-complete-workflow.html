<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¬ AI ì‡¼ì¸  ì œì‘ í†µí•© ì›Œí¬í”Œë¡œìš°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
        }
        
        .workflow-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }
        
        .drop-zone {
            border: 3px dashed #64748b;
            transition: all 0.3s ease;
            min-height: 200px;
        }
        
        .drop-zone.dragover {
            border-color: #3b82f6;
            background-color: rgba(59, 130, 246, 0.1);
            transform: scale(1.02);
        }
        
        .step-indicator {
            position: relative;
            padding-left: 2rem;
        }
        
        .step-indicator::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 50%;
            background: #64748b;
        }
        
        .step-indicator.active::before {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            animation: pulse 2s infinite;
        }
        
        .step-indicator.completed::before {
            background: #10b981;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: translateY(-50%) scale(1); }
            50% { opacity: 0.8; transform: translateY(-50%) scale(1.1); }
        }
        
        .industry-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .industry-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }
        
        .industry-card.selected {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }
        
        .narration-segment {
            background: rgba(0, 0, 0, 0.2);
            border-left: 4px solid #3b82f6;
            transition: all 0.3s ease;
        }
        
        .narration-segment:hover {
            background: rgba(59, 130, 246, 0.1);
        }
    </style>
</head>
<body class="min-h-screen text-white">
    <div class="container mx-auto px-6 py-8">
        <!-- Header -->
        <div class="text-center mb-12">
            <h1 class="text-5xl font-bold bg-gradient-to-r from-blue-400 to-purple-600 bg-clip-text text-transparent mb-4">
                ğŸ¬ AI ì‡¼ì¸  ì œì‘ ê³µì¥
            </h1>
            <p class="text-xl text-slate-300">ì´ë¯¸ì§€ ë¶„ì„ â†’ AI ì •ë ¬ â†’ ë‚˜ë ˆì´ì…˜ ìƒì„±ì„ í•œ ë²ˆì—!</p>
        </div>

        <!-- ì§„í–‰ ë‹¨ê³„ í‘œì‹œ -->
        <div class="workflow-card rounded-2xl p-8 mb-8">
            <h2 class="text-2xl font-bold mb-6">ğŸ“‹ ì›Œí¬í”Œë¡œìš° ì§„í–‰ ìƒí™©</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="step-indicator" id="step1">
                    <div class="text-lg font-semibold">1. ì´ë¯¸ì§€ ì—…ë¡œë“œ</div>
                    <div class="text-sm text-slate-400">5-10ì¥ ì œí’ˆ ì´ë¯¸ì§€</div>
                </div>
                <div class="step-indicator" id="step2">
                    <div class="text-lg font-semibold">2. AI íŒŒì¼ëª… ì •ë ¬</div>
                    <div class="text-sm text-slate-400">ìµœì  ìˆœì„œ ìë™ ê²°ì •</div>
                </div>
                <div class="step-indicator" id="step3">
                    <div class="text-lg font-semibold">3. ì´ë¯¸ì§€ ë¶„ì„</div>
                    <div class="text-sm text-slate-400">ì „ë¬¸ì  ìƒí’ˆ ì„¤ëª… ìƒì„±</div>
                </div>
                <div class="step-indicator" id="step4">
                    <div class="text-lg font-semibold">4. ë‚˜ë ˆì´ì…˜ ì œì‘</div>
                    <div class="text-sm text-slate-400">ì´ë¯¸ì§€ë‹¹ 5ì´ˆì”© ë°°ì •</div>
                </div>
            </div>
        </div>

        <!-- íŒŒì¼ ì—…ë¡œë“œ -->
        <div class="workflow-card rounded-2xl p-8 mb-8">
            <h2 class="text-2xl font-bold mb-6">ğŸ“ ì œí’ˆ ì´ë¯¸ì§€ ì—…ë¡œë“œ</h2>
            
            <div class="drop-zone rounded-xl p-8 text-center cursor-pointer" id="dropZone">
                <div class="text-4xl mb-4">ğŸ¯</div>
                <div class="text-xl font-semibold mb-2">ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒ</div>
                <div class="text-slate-400">5-10ì¥ì˜ ì œí’ˆ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</div>
                <input type="file" id="fileInput" accept="image/*" multiple class="hidden">
            </div>

            <!-- ì„ íƒëœ íŒŒì¼ í‘œì‹œ -->
            <div id="selectedFiles" class="mt-6 hidden">
                <h3 class="text-lg font-semibold mb-4">ì„ íƒëœ íŒŒì¼ (<span id="fileCount">0</span>ì¥)</h3>
                <div id="fileList" class="grid grid-cols-1 md:grid-cols-2 gap-3"></div>
            </div>
        </div>

        <!-- ì—…ì¢… ì„ íƒ -->
        <div class="workflow-card rounded-2xl p-8 mb-8" id="industrySection" style="display: none;">
            <h2 class="text-2xl font-bold mb-6">ğŸ­ ì—…ì¢… ì„ íƒ</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="industry-card workflow-card rounded-xl p-6 border border-slate-600" data-industry="auto">
                    <div class="text-2xl mb-3">ğŸš—</div>
                    <div class="text-lg font-semibold">ì¤‘ê³ ì°¨ ë§¤ë§¤</div>
                    <div class="text-sm text-slate-400 mt-2">ìë™ì°¨, ì°¨ëŸ‰ ë¶€í’ˆ, ìš©í’ˆ</div>
                </div>
                
                <div class="industry-card workflow-card rounded-xl p-6 border border-slate-600" data-industry="wheel-restoration">
                    <div class="text-2xl mb-3">ğŸ›</div>
                    <div class="text-lg font-semibold">ìë™ì°¨ íœ  ë³µì›</div>
                    <div class="text-sm text-slate-400 mt-2">íœ  ë¦¬í˜ì–´, íœ  ì¬ìƒ, ì•Œë¡œì´ íœ , ìŠ¤í¬ë˜ì¹˜ ì œê±°, ì°Œê·¸ëŸ¬ì§ ë³µì›</div>
                </div>
                
                <div class="industry-card workflow-card rounded-xl p-6 border border-slate-600" data-industry="fashion">
                    <div class="text-2xl mb-3">ğŸ‘—</div>
                    <div class="text-lg font-semibold">íŒ¨ì…˜/ì˜ë¥˜</div>
                    <div class="text-sm text-slate-400 mt-2">ì˜ë¥˜, ì‹ ë°œ, ì•¡ì„¸ì„œë¦¬</div>
                </div>
                
                <div class="industry-card workflow-card rounded-xl p-6 border border-slate-600" data-industry="electronics">
                    <div class="text-2xl mb-3">ğŸ“±</div>
                    <div class="text-lg font-semibold">ì „ìì œí’ˆ</div>
                    <div class="text-sm text-slate-400 mt-2">ìŠ¤ë§ˆíŠ¸í°, ë…¸íŠ¸ë¶, ITê¸°ê¸°</div>
                </div>
                
                <div class="industry-card workflow-card rounded-xl p-6 border border-slate-600" data-industry="furniture">
                    <div class="text-2xl mb-3">ğŸª‘</div>
                    <div class="text-lg font-semibold">ê°€êµ¬/ìƒí™œìš©í’ˆ</div>
                    <div class="text-sm text-slate-400 mt-2">ê°€êµ¬, ì¸í…Œë¦¬ì–´, ìƒí™œìš©í’ˆ</div>
                </div>
                
                <div class="industry-card workflow-card rounded-xl p-6 border border-slate-600" data-industry="general">
                    <div class="text-2xl mb-3">ğŸ“¦</div>
                    <div class="text-lg font-semibold">ì¼ë°˜ ìƒí’ˆ</div>
                    <div class="text-sm text-slate-400 mt-2">ê¸°íƒ€ ëª¨ë“  ìƒí’ˆ</div>
                </div>
            </div>
        </div>

        <!-- ì‹œì‘ ë²„íŠ¼ -->
        <div class="text-center mb-8" id="startSection" style="display: none;">
            <button id="startWorkflowBtn" 
                    class="px-8 py-4 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl font-semibold text-lg hover:from-blue-600 hover:to-purple-700 transition-all transform hover:scale-105">
                ğŸš€ AI ì‡¼ì¸  ì œì‘ ì‹œì‘
            </button>
        </div>

        <!-- ì§„í–‰ ìƒí™© -->
        <div id="progressSection" class="workflow-card rounded-2xl p-8 mb-8" style="display: none;">
            <h2 class="text-2xl font-bold mb-6">âš¡ ì²˜ë¦¬ ì§„í–‰ ìƒí™©</h2>
            
            <div class="flex items-center justify-between mb-4">
                <div class="text-lg" id="currentTask">ì²˜ë¦¬ ì‹œì‘...</div>
                <div class="text-lg font-semibold" id="progressText">0%</div>
            </div>
            
            <div class="w-full bg-slate-700 rounded-full h-3 mb-6">
                <div id="progressBar" class="bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
            
            <!-- ìƒì„¸ ì§„í–‰ ìƒí™© -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                <div>
                    <div class="text-sm text-slate-400">ê²½ê³¼ ì‹œê°„</div>
                    <div class="text-xl font-bold text-blue-400" id="elapsedTime">0ì´ˆ</div>
                </div>
                <div>
                    <div class="text-sm text-slate-400">í˜„ì¬ ë‹¨ê³„</div>
                    <div class="text-xl font-bold text-green-400" id="currentStage">ì¤€ë¹„</div>
                </div>
                <div>
                    <div class="text-sm text-slate-400">ì²˜ë¦¬ëœ ì´ë¯¸ì§€</div>
                    <div class="text-xl font-bold text-purple-400" id="processedImages">0</div>
                </div>
                <div>
                    <div class="text-sm text-slate-400">ì˜ˆìƒ ë‚˜ë ˆì´ì…˜</div>
                    <div class="text-xl font-bold text-yellow-400" id="estimatedDuration">0ì´ˆ</div>
                </div>
            </div>
        </div>

        <!-- ìµœì¢… ê²°ê³¼ -->
        <div id="resultSection" class="workflow-card rounded-2xl p-8" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">ğŸ‰ ì‡¼ì¸  ì œì‘ ì™„ë£Œ!</h2>
                <div class="flex gap-3">
                    <button id="downloadScript" class="px-4 py-2 bg-green-600 rounded-lg hover:bg-green-700 transition-colors">
                        ğŸ“ ë‚˜ë ˆì´ì…˜ ë‹¤ìš´ë¡œë“œ
                    </button>
                    <button id="exportData" class="px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors">
                        ğŸ“Š ì „ì²´ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
                    </button>
                </div>
            </div>
            
            <!-- ì›Œí¬í”Œë¡œìš° ìš”ì•½ -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <div class="p-4 bg-slate-800 rounded-xl text-center">
                    <div class="text-sm text-slate-400">ì´ ì´ë¯¸ì§€</div>
                    <div class="text-2xl font-bold text-blue-400" id="totalImages">0ì¥</div>
                </div>
                <div class="p-4 bg-slate-800 rounded-xl text-center">
                    <div class="text-sm text-slate-400">ë‚˜ë ˆì´ì…˜ ê¸¸ì´</div>
                    <div class="text-2xl font-bold text-green-400" id="narrationLength">0ì´ˆ</div>
                </div>
                <div class="p-4 bg-slate-800 rounded-xl text-center">
                    <div class="text-sm text-slate-400">ì²˜ë¦¬ ì‹œê°„</div>
                    <div class="text-2xl font-bold text-purple-400" id="processingTime">0ì´ˆ</div>
                </div>
                <div class="p-4 bg-slate-800 rounded-xl text-center">
                    <div class="text-sm text-slate-400">ì„±ê³µë¥ </div>
                    <div class="text-2xl font-bold text-yellow-400" id="successRate">100%</div>
                </div>
            </div>

            <!-- ì´ë¯¸ì§€ ë¶„ì„ ê²°ê³¼ -->
            <div class="mb-8">
                <h3 class="text-xl font-bold mb-4">ğŸ“¸ ì´ë¯¸ì§€ ë¶„ì„ ê²°ê³¼</h3>
                <div id="analysisResults" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
            </div>

            <!-- ë‚˜ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ -->
            <div class="mb-8">
                <h3 class="text-xl font-bold mb-4">ğŸ™ï¸ ìƒì„±ëœ ë‚˜ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸</h3>
                <div class="bg-slate-800 rounded-xl p-6">
                    <div id="fullScript" class="text-slate-300 leading-relaxed whitespace-pre-wrap"></div>
                </div>
            </div>

            <!-- ì„¸ê·¸ë¨¼íŠ¸ë³„ ë‚˜ë ˆì´ì…˜ -->
            <div>
                <h3 class="text-xl font-bold mb-4">â±ï¸ ì‹œê°„ë³„ ë‚˜ë ˆì´ì…˜ êµ¬ì„±</h3>
                <div id="narrationSegments" class="space-y-3"></div>
            </div>
        </div>
    </div>

    <script>
        let selectedFiles = [];
        let selectedIndustry = 'auto';
        let workflowData = {};
        let startTime = 0;

        // DOM ìš”ì†Œë“¤
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const selectedFilesDiv = document.getElementById('selectedFiles');
        const fileList = document.getElementById('fileList');
        const fileCount = document.getElementById('fileCount');
        const industrySection = document.getElementById('industrySection');
        const startSection = document.getElementById('startSection');
        const progressSection = document.getElementById('progressSection');
        const resultSection = document.getElementById('resultSection');

        // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            
            const files = Array.from(e.dataTransfer.files).filter(file => file.type.startsWith('image/'));
            handleFileSelection(files);
        });

        dropZone.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', (e) => {
            const files = Array.from(e.target.files);
            handleFileSelection(files);
        });

        // íŒŒì¼ ì„ íƒ ì²˜ë¦¬
        function handleFileSelection(files) {
            if (files.length > 10) {
                alert('ìµœëŒ€ 10ì¥ì˜ ì´ë¯¸ì§€ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            if (files.length < 5) {
                alert('ìµœì†Œ 5ì¥ì˜ ì´ë¯¸ì§€ê°€ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            selectedFiles = files.slice(0, 10);
            displaySelectedFiles();
            updateStepIndicator(1);
            
            industrySection.style.display = 'block';
            updateEstimatedDuration();
        }

        // ì„ íƒëœ íŒŒì¼ í‘œì‹œ
        function displaySelectedFiles() {
            if (selectedFiles.length === 0) {
                selectedFilesDiv.classList.add('hidden');
                return;
            }

            selectedFilesDiv.classList.remove('hidden');
            fileCount.textContent = selectedFiles.length;

            fileList.innerHTML = selectedFiles.map((file, index) => `
                <div class="flex items-center justify-between p-3 bg-slate-800 rounded-lg">
                    <div class="flex items-center">
                        <span class="w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-sm font-bold mr-3">
                            ${index + 1}
                        </span>
                        <span class="text-sm">${file.name}</span>
                    </div>
                    <div class="text-sm text-slate-400">
                        ${(file.size / 1024 / 1024).toFixed(2)} MB
                    </div>
                </div>
            `).join('');
        }

        // ì—…ì¢… ì„ íƒ ì²˜ë¦¬
        document.querySelectorAll('.industry-card').forEach(card => {
            card.addEventListener('click', () => {
                // ì´ì „ ì„ íƒ ì œê±°
                document.querySelectorAll('.industry-card').forEach(c => c.classList.remove('selected'));
                
                // ìƒˆ ì„ íƒ í™œì„±í™”
                card.classList.add('selected');
                selectedIndustry = card.dataset.industry;
                
                startSection.style.display = 'block';
                updateEstimatedDuration();
            });
        });

        // ì˜ˆìƒ ë‚˜ë ˆì´ì…˜ ì‹œê°„ ì—…ë°ì´íŠ¸
        function updateEstimatedDuration() {
            if (selectedFiles.length > 0) {
                const duration = selectedFiles.length * 5;
                document.getElementById('estimatedDuration').textContent = `${duration}ì´ˆ`;
            }
        }

        // ë‹¨ê³„ í‘œì‹œê¸° ì—…ë°ì´íŠ¸
        function updateStepIndicator(step) {
            for (let i = 1; i <= 4; i++) {
                const stepElement = document.getElementById(`step${i}`);
                stepElement.classList.remove('active', 'completed');
                
                if (i < step) {
                    stepElement.classList.add('completed');
                } else if (i === step) {
                    stepElement.classList.add('active');
                }
            }
        }

        // ì›Œí¬í”Œë¡œìš° ì‹œì‘
        document.getElementById('startWorkflowBtn').addEventListener('click', () => {
            if (selectedFiles.length < 5) {
                alert('ìµœì†Œ 5ì¥ì˜ ì´ë¯¸ì§€ê°€ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            if (!selectedIndustry) {
                alert('ì—…ì¢…ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            startWorkflow();
        });

        // ì›Œí¬í”Œë¡œìš° ì‹¤í–‰
        async function startWorkflow() {
            startTime = Date.now();
            progressSection.style.display = 'block';
            resultSection.style.display = 'none';
            
            try {
                // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
                updateProgress(0, 'ì›Œí¬í”Œë¡œìš° ì‹œì‘...', 'ì¤€ë¹„');
                updateStepIndicator(2);
                
                // FormData ìƒì„±
                const formData = new FormData();
                selectedFiles.forEach(file => {
                    formData.append('images', file);
                });
                formData.append('sortMethod', 'ai');
                formData.append('industry', selectedIndustry);
                
                updateProgress(25, 'AIê°€ íŒŒì¼ëª…ì„ ë¶„ì„í•˜ëŠ” ì¤‘...', 'íŒŒì¼ëª… ì •ë ¬');
                
                // í†µí•© ì›Œí¬í”Œë¡œìš° API í˜¸ì¶œ
                const response = await fetch('/api/complete-workflow', {
                    method: 'POST',
                    body: formData
                });
                
                updateProgress(50, 'ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ëŠ” ì¤‘...', 'ì´ë¯¸ì§€ ë¶„ì„');
                updateStepIndicator(3);
                
                const result = await response.json();
                
                if (!response.ok || !result.success) {
                    throw new Error(result.error || 'ì›Œí¬í”Œë¡œìš° ì‹¤íŒ¨');
                }
                
                updateProgress(75, 'ë‚˜ë ˆì´ì…˜ì„ ìƒì„±í•˜ëŠ” ì¤‘...', 'ë‚˜ë ˆì´ì…˜ ì œì‘');
                updateStepIndicator(4);
                
                workflowData = result;
                
                updateProgress(100, 'ì›Œí¬í”Œë¡œìš° ì™„ë£Œ!', 'ì™„ë£Œ');
                
                // ê²°ê³¼ í‘œì‹œ
                displayResults();
                
            } catch (error) {
                console.error('ì›Œí¬í”Œë¡œìš° ì˜¤ë¥˜:', error);
                updateProgress(0, `ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, 'ì‹¤íŒ¨');
            }
        }

        // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
        function updateProgress(percentage, task, stage) {
            document.getElementById('progressBar').style.width = `${percentage}%`;
            document.getElementById('currentTask').textContent = task;
            document.getElementById('progressText').textContent = `${percentage}%`;
            document.getElementById('currentStage').textContent = stage;
            
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            document.getElementById('elapsedTime').textContent = `${elapsed}ì´ˆ`;
            
            if (workflowData.analysis && workflowData.analysis.results) {
                document.getElementById('processedImages').textContent = workflowData.analysis.results.length;
            }
        }

        // ê²°ê³¼ í‘œì‹œ
        function displayResults() {
            const { workflow, analysis, narration } = workflowData;
            
            // ìš”ì•½ í†µê³„
            document.getElementById('totalImages').textContent = `${workflow.totalImages}ì¥`;
            document.getElementById('narrationLength').textContent = `${narration.totalDuration}ì´ˆ`;
            document.getElementById('processingTime').textContent = `${workflow.processingTime}ì´ˆ`;
            
            const successRate = analysis.results.length > 0 
                ? (analysis.successCount / analysis.results.length * 100).toFixed(1)
                : 0;
            document.getElementById('successRate').textContent = `${successRate}%`;
            
            // ì´ë¯¸ì§€ ë¶„ì„ ê²°ê³¼
            const analysisResultsDiv = document.getElementById('analysisResults');
            analysisResultsDiv.innerHTML = analysis.results.map((result, index) => `
                <div class="workflow-card rounded-xl p-4">
                    <div class="font-semibold text-lg mb-2">${result.filename}</div>
                    ${result.success ? `
                        <div class="text-green-400 mb-2">âœ… ë¶„ì„ ì„±ê³µ</div>
                        <div class="text-slate-300 text-sm leading-relaxed">
                            ${result.analysis}
                        </div>
                    ` : `
                        <div class="text-red-400 mb-2">âŒ ë¶„ì„ ì‹¤íŒ¨</div>
                        <div class="text-slate-400 text-sm">
                            ${result.error}
                        </div>
                    `}
                </div>
            `).join('');
            
            // ë‚˜ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸
            document.getElementById('fullScript').textContent = narration.fullScript;
            
            // ì„¸ê·¸ë¨¼íŠ¸ë³„ ë‚˜ë ˆì´ì…˜
            const segmentsDiv = document.getElementById('narrationSegments');
            segmentsDiv.innerHTML = narration.segments.map((segment, index) => `
                <div class="narration-segment rounded-lg p-4">
                    <div class="flex justify-between items-start mb-2">
                        <div class="font-semibold">
                            ì´ë¯¸ì§€ ${segment.imageIndex + 1} (${segment.startTime}ì´ˆ - ${segment.endTime}ì´ˆ)
                        </div>
                        <div class="text-sm text-blue-400">5ì´ˆ</div>
                    </div>
                    <div class="text-slate-300 text-sm leading-relaxed">
                        ${segment.script}
                    </div>
                </div>
            `).join('');
            
            resultSection.style.display = 'block';
        }

        // ë‚˜ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ ë‹¤ìš´ë¡œë“œ
        document.getElementById('downloadScript').addEventListener('click', () => {
            if (!workflowData.narration) return;
            
            const script = `
AI ì‡¼ì¸  ë‚˜ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸
========================

ì—…ì¢…: ${selectedIndustry}
ì´ ì´ë¯¸ì§€: ${workflowData.workflow.totalImages}ì¥
ë‚˜ë ˆì´ì…˜ ê¸¸ì´: ${workflowData.narration.totalDuration}ì´ˆ
ìƒì„±ì¼: ${new Date().toLocaleString()}

ì „ì²´ ìŠ¤í¬ë¦½íŠ¸:
${workflowData.narration.fullScript}

ì‹œê°„ë³„ êµ¬ì„±:
${workflowData.narration.segments.map(seg => 
    `[${seg.startTime}s-${seg.endTime}s] ${seg.script}`
).join('\n')}

í•µì‹¬ í‚¤ì›Œë“œ:
${workflowData.narration.keywords.join(', ')}
            `;
            
            downloadFile(`narration-script-${new Date().toISOString().slice(0, 19)}.txt`, script, 'text/plain');
        });

        // ì „ì²´ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
        document.getElementById('exportData').addEventListener('click', () => {
            if (!workflowData) return;
            
            const exportData = {
                ...workflowData,
                exportInfo: {
                    timestamp: new Date().toISOString(),
                    selectedIndustry: selectedIndustry,
                    totalFiles: selectedFiles.length,
                    fileNames: selectedFiles.map(f => f.name)
                }
            };
            
            const json = JSON.stringify(exportData, null, 2);
            downloadFile(`workflow-data-${new Date().toISOString().slice(0, 19)}.json`, json, 'application/json');
        });

        // íŒŒì¼ ë‹¤ìš´ë¡œë“œ í—¬í¼
        function downloadFile(filename, content, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        // ê¸°ë³¸ ì—…ì¢… ì„ íƒ
        document.querySelector('[data-industry="auto"]').click();
    </script>
</body>
</html>